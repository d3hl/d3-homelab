---
- name: Install plugins core
  ansible.builtin.dnf:
    state: present
    name:
      - dnf-plugins-core
      - ncurses

- name: Add Docker repo
  ansible.builtin.shell: |
    dnf config-manager --add-repo https://download.docker.com/linux/rhel/docker-ce.repo
  register: repo_cmd
  changed_when: repo_cmd.rc != 0

- name: Install Docker components
  ansible.builtin.dnf:
    state: present
    name:
      - docker-ce
      - docker-ce-cli
      - containerd.io
      - docker-buildx-plugin
      - docker-compose-plugin
  notify: Restart docker service